package units

import (
	"math"
	"testing"
)

func Test_AllPressureUnits_Conversions(t *testing.T) {
	var pressureUnits []Unit
	for _, u := range _unitMap {
		if u.Quantity == Pressure {
			pressureUnits = append(pressureUnits, u)
		}
	}
	for _, u := range pressureUnits {
		t.Run(u.Name, func(t *testing.T) {
			v := 1.0
			toPascal := MustConvertFloat(v, u, Pascal)
			fromPascal := MustConvertFloat(toPascal.Float(), Pascal, u)
			if math.Abs(fromPascal.Float()-v) > 1e-8 {
				t.Fatalf("round-trip conversion failed for %s: got %g, want %g", u.Name, fromPascal.Float(), v)
			}
		})
	}
}

func Test_Pressure_Conversions(t *testing.T) {
	// create conversion tests for the significant pressure units
	var conversionTests = []conversionTest{
		{"pascal", "pascal", "1"},
		{"pascal", "technical atmosphere", "0.00001019716"},
		{"pascal", "standard atmosphere", "0.00000986923"},
		{"pascal", "bar", "0.00001"},
		{"pascal", "barye", "10"},
		{"pascal", "inch of Water Column", "0.00401463"},
		{"pascal", "inch of Mercury", "0.0002952998"},
		{"pascal", "meter of Water Column", "0.0001019716"},
		{"pascal", "meter of Mercury", "0.00000750062"},
		{"pascal", "newton per square meter", "1"},
		{"pascal", "pound-force per square inch", "0.0001450377"},
		{"pascal", "torr", "0.00750062"},
		{"technical atmosphere", "pascal", "98066.5"},
		{"technical atmosphere", "technical atmosphere", "1"},
		{"technical atmosphere", "standard atmosphere", "0.967841"},
		{"technical atmosphere", "bar", "0.980665"},
		{"technical atmosphere", "barye", "980665"},
		{"technical atmosphere", "inch of Water Column", "393.700803"},
		{"technical atmosphere", "inch of Mercury", "28.959018"},
		{"technical atmosphere", "meter of Water Column", "10"},
		{"technical atmosphere", "meter of Mercury", "0.735559"},
		{"technical atmosphere", "newton per square meter", "98066.5"},
		{"technical atmosphere", "pound-force per square inch", "14.223344"},
		{"technical atmosphere", "torr", "735.559066"},
		{"standard atmosphere", "pascal", "101325"},
		{"standard atmosphere", "technical atmosphere", "1.033227"},
		{"standard atmosphere", "standard atmosphere", "1"},
		{"standard atmosphere", "bar", "1.01325"},
		{"standard atmosphere", "barye", "1013250"},
		{"standard atmosphere", "inch of Water Column", "406.782478"},
		{"standard atmosphere", "inch of Mercury", "29.921252"},
		{"standard atmosphere", "meter of Water Column", "10.332275"},
		{"standard atmosphere", "meter of Mercury", "0.76"},
		{"standard atmosphere", "newton per square meter", "101325"},
		{"standard atmosphere", "pound-force per square inch", "14.695949"},
		{"standard atmosphere", "torr", "759.99982"},
		{"bar", "pascal", "100000"},
		{"bar", "technical atmosphere", "1.019716"},
		{"bar", "standard atmosphere", "0.986923"},
		{"bar", "bar", "1"},
		{"bar", "barye", "1000000"},
		{"bar", "inch of Water Column", "401.463092"},
		{"bar", "inch of Mercury", "29.52998"},
		{"bar", "meter of Water Column", "10.197162"},
		{"bar", "meter of Mercury", "0.750062"},
		{"bar", "newton per square meter", "100000"},
		{"bar", "pound-force per square inch", "14.503774"},
		{"bar", "torr", "750.061505"},
		{"barye", "pascal", "0.1"},
		{"barye", "technical atmosphere", "0.000001019716"},
		{"barye", "standard atmosphere", "0.000000986923"},
		{"barye", "bar", "0.000001"},
		{"barye", "barye", "1"},
		{"barye", "inch of Water Column", "0.000401463"},
		{"barye", "inch of Mercury", "0.00002952998"},
		{"barye", "meter of Water Column", "0.00001019716"},
		{"barye", "meter of Mercury", "0.000000750062"},
		{"barye", "newton per square meter", "0.1"},
		{"barye", "pound-force per square inch", "0.00001450377"},
		{"barye", "torr", "0.000750062"},
		{"inch of Water Column", "pascal", "249.0889"},
		{"inch of Water Column", "technical atmosphere", "0.00254"},
		{"inch of Water Column", "standard atmosphere", "0.002458316"},
		{"inch of Water Column", "bar", "0.002490889"},
		{"inch of Water Column", "barye", "2490.889"},
		{"inch of Water Column", "inch of Water Column", "1"},
		{"inch of Water Column", "inch of Mercury", "0.0735559"},
		{"inch of Water Column", "meter of Water Column", "0.0254"},
		{"inch of Water Column", "meter of Mercury", "0.00186832"},
		{"inch of Water Column", "newton per square meter", "249.0889"},
		{"inch of Water Column", "pound-force per square inch", "0.0361273"},
		{"inch of Water Column", "torr", "1.86832"},
		{"inch of Mercury", "pascal", "3386.389"},
		{"inch of Mercury", "technical atmosphere", "0.0345316"},
		{"inch of Mercury", "standard atmosphere", "0.0334211"},
		{"inch of Mercury", "bar", "0.0338639"},
		{"inch of Mercury", "barye", "33863.89"},
		{"inch of Mercury", "inch of Water Column", "13.595102"},
		{"inch of Mercury", "inch of Mercury", "1"},
		{"inch of Mercury", "meter of Water Column", "0.345316"},
		{"inch of Mercury", "meter of Mercury", "0.0254"},
		{"inch of Mercury", "newton per square meter", "3386.389"},
		{"inch of Mercury", "pound-force per square inch", "0.491154"},
		{"inch of Mercury", "torr", "25.4"},
		{"meter of Water Column", "pascal", "9806.65"},
		{"meter of Water Column", "technical atmosphere", "0.1"},
		{"meter of Water Column", "standard atmosphere", "0.0967841"},
		{"meter of Water Column", "bar", "0.0980665"},
		{"meter of Water Column", "barye", "98066.5"},
		{"meter of Water Column", "inch of Water Column", "39.37008"},
		{"meter of Water Column", "inch of Mercury", "2.895902"},
		{"meter of Water Column", "meter of Water Column", "1"},
		{"meter of Water Column", "meter of Mercury", "0.0735559"},
		{"meter of Water Column", "newton per square meter", "9806.65"},
		{"meter of Water Column", "pound-force per square inch", "1.422334"},
		{"meter of Water Column", "torr", "73.555907"},
		{"meter of Mercury", "pascal", "133322.4"},
		{"meter of Mercury", "technical atmosphere", "1.35951"},
		{"meter of Mercury", "standard atmosphere", "1.31579"},
		{"meter of Mercury", "bar", "1.333224"},
		{"meter of Mercury", "barye", "1333224"},
		{"meter of Mercury", "inch of Water Column", "535.240229"},
		{"meter of Mercury", "inch of Mercury", "39.370078"},
		{"meter of Mercury", "meter of Water Column", "13.595101"},
		{"meter of Mercury", "meter of Mercury", "1"},
		{"meter of Mercury", "newton per square meter", "133322.4"},
		{"meter of Mercury", "pound-force per square inch", "19.33678"},
		{"meter of Mercury", "torr", "1000"},
		{"newton per square meter", "pascal", "1"},
		{"newton per square meter", "technical atmosphere", "0.00001019716"},
		{"newton per square meter", "standard atmosphere", "0.00000986923"},
		{"newton per square meter", "bar", "0.00001"},
		{"newton per square meter", "barye", "10"},
		{"newton per square meter", "inch of Water Column", "0.00401463"},
		{"newton per square meter", "inch of Mercury", "0.0002952998"},
		{"newton per square meter", "meter of Water Column", "0.0001019716"},
		{"newton per square meter", "meter of Mercury", "0.00000750062"},
		{"newton per square meter", "newton per square meter", "1"},
		{"newton per square meter", "pound-force per square inch", "0.0001450377"},
		{"newton per square meter", "torr", "0.00750062"},
		{"pound-force per square inch", "pascal", "6894.757"},
		{"pound-force per square inch", "technical atmosphere", "0.070307"},
		{"pound-force per square inch", "standard atmosphere", "0.068046"},
		{"pound-force per square inch", "bar", "0.0689476"},
		{"pound-force per square inch", "barye", "68947.57"},
		{"pound-force per square inch", "inch of Water Column", "27.679905"},
		{"pound-force per square inch", "inch of Mercury", "2.03602"},
		{"pound-force per square inch", "meter of Water Column", "0.70307"},
		{"pound-force per square inch", "meter of Mercury", "0.0517149"},
		{"pound-force per square inch", "newton per square meter", "6894.757"},
		{"pound-force per square inch", "pound-force per square inch", "1"},
		{"pound-force per square inch", "torr", "51.714918"},
		{"torr", "pascal", "133.3224"},
		{"torr", "technical atmosphere", "0.00135951"},
		{"torr", "standard atmosphere", "0.00131579"},
		{"torr", "bar", "0.001333224"},
		{"torr", "barye", "1333.224"},
		{"torr", "inch of Water Column", "0.53524"},
		{"torr", "inch of Mercury", "0.0393701"},
		{"torr", "meter of Water Column", "0.0135951"},
		{"torr", "meter of Mercury", "0.001"},
		{"torr", "newton per square meter", "133.3224"},
		{"torr", "pound-force per square inch", "0.01933678"},
		{"torr", "torr", "1"},
	}

	testConversions(t, conversionTests)
}
